<div class="row">
  <select-filter class="col col-sm-3" field="Show Workflow Steps" [values]="availableWorkflow" [(selected)]="selectedWorkflow"></select-filter>
  <select-filter class="col col-sm-3" field="Distributions" [values]="managedBundleService.getAvailableDistributions()" [(selected)]="selectedDistributions"></select-filter>
  <select-filter class="col col-sm-3" field="Targets" [values]="managedBundleService.getAvailableTargets()" [(selected)]="selectedTargets"></select-filter>
</div>
<div class="row m-1">
  <div *ngFor="let status of getWorkflow()"
    [ngClass]="'card my-2 ' + getCardFormat(status)" style="width: 100%">
    <div class="card-header">
      <b>{{ status.ord }}) {{ status.name }}</b>
      <div *ngIf="status.tracStatus" [ngClass]="'badge-pill float-right mx-2 ' + ((isValidStage(status)) ? 'badge-light' : 'badge-info')"><b>Trac: {{ status.tracStatus | uppercase }}<span *ngIf="status.tracResolution"> as "{{status.tracResolution }}"</span></b><i [ngClass]="status.override ? 'fa fa-chevron-right ml-2' : 'fa fa-lock ml-2'" aria-hidden="true"></i></div>
      <div *ngIf="status.repoSuiteTag" class="badge-pill badge-success float-right mx-2"><b>Bundle-Tag: {{ status.repoSuiteTag | uppercase }}</b></div>
    </div>
    <div class="card-body">
      <h5 class="card-title">{{ status.comment }}
        <div *ngIf="isValidStage(status)" class="float-right my-2" style="font-size:larger">
            <b>Stage: {{ status.stage | uppercase }}</b>
          </div>
        </h5>

        <div class="card-columns">
          <div *ngFor="let bi of getManagedBundleInfosForStatus(status)" [ngClass]="'card ' + ((bi.managedBundle === highlighted) ? 'text-white bg-secondary' : 'border-info')"
            (mouseover)="highlighted = bi.managedBundle" (mouseleave)="highlighted = null">
            <div class="card-header">
              <b> {{ bi.managedBundle.id }}</b> --> [{{ bi.managedBundle.target }}]
            </div>
            <div class="card-body">
              <h5 class="card-title">{{ bi.subject }}</h5>
              <div>Creator: {{ bi.creator }}</div>
              <div *ngIf="bi.managedBundle.ticketUrl">Ticket: <a href="{{ bi.managedBundle.ticketUrl }}" target="_blank" style="color: inherit; outline: 0;"><b>#{{ bi.managedBundle.ticket }}</b></a></div>
            </div>
            <!--div>{{ bi | json}}</div>
            <div>{{ status | json}}</div-->
          </div>
        </div>

        <div *ngIf="candidateForStages(status).length > 0" class="float-right"><b>Candiates For Stage: <span *ngFor="let stage of candidateForStages(status)">{{ stage.stage | uppercase }}</span></b></div>
    </div>
  </div>
</div>
